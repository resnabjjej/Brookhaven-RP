local player = game.Players.LocalPlayer
local players = game.Players
local guiName = "TeleportMenuV2"

-- Alte GUI entfernen wenn sie schon existiert
local oldGui = player:FindFirstChild("PlayerGui"):FindFirstChild(guiName)
if oldGui then
	oldGui:Destroy()
end

local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.ResetOnSpawn = false
gui.Name = guiName

-- Schickes Floating-Icon (nur ein einziges)
local openBtn = Instance.new("ImageButton", gui)
openBtn.Size = UDim2.new(0, 60, 0, 60)
openBtn.Position = UDim2.new(0, 20, 0.5, -30)
openBtn.BackgroundTransparency = 1
openBtn.Image = "rbxassetid://3926305904" -- rundes Symbol
openBtn.ImageRectOffset = Vector2.new(924, 724)
openBtn.ImageRectSize = Vector2.new(36, 36)
openBtn.Draggable = true
openBtn.Active = true
openBtn.Visible = true

-- Haupt-Men√º
local menu = Instance.new("Frame", gui)
menu.Size = UDim2.new(0, 320, 0, 420)
menu.Position = UDim2.new(0.5, -160, 0.5, -210)
menu.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
menu.BorderSizePixel = 0
menu.Visible = false

-- Abgerundete Ecken
local corner = Instance.new("UICorner", menu)
corner.CornerRadius = UDim.new(0, 12)

-- Titel
local title = Instance.new("TextLabel", menu)
title.Size = UDim2.new(1, -40, 0, 40)
title.Position = UDim2.new(0, 20, 0, 10)
title.Text = "üéØ Teleport-Men√º"
title.TextColor3 = Color3.new(1, 1, 1)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.TextXAlignment = Enum.TextXAlignment.Left

-- Schlie√üen-Button
local closeBtn = Instance.new("TextButton", menu)
closeBtn.Size = UDim2.new(0, 30, 0, 30)
closeBtn.Position = UDim2.new(1, -40, 0, 10)
closeBtn.Text = "‚úñ"
closeBtn.Font = Enum.Font.Gotham
closeBtn.TextColor3 = Color3.new(1, 1, 1)
closeBtn.BackgroundColor3 = Color3.fromRGB(50, 0, 0)
local cbCorner = Instance.new("UICorner", closeBtn)
cbCorner.CornerRadius = UDim.new(0, 6)

-- Button Spieler anzeigen
local listBtn = Instance.new("TextButton", menu)
listBtn.Size = UDim2.new(1, -40, 0, 40)
listBtn.Position = UDim2.new(0, 20, 0, 60)
listBtn.Text = "üßç Spieler anzeigen"
listBtn.Font = Enum.Font.GothamBold
listBtn.TextColor3 = Color3.new(1, 1, 1)
listBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 80)
local lbCorner = Instance.new("UICorner", listBtn)
lbCorner.CornerRadius = UDim.new(0, 8)

-- Scroll-Bereich f√ºr Spielernamen
local scroll = Instance.new("ScrollingFrame", menu)
scroll.Size = UDim2.new(1, -40, 1, -120)
scroll.Position = UDim2.new(0, 20, 0, 110)
scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
scroll.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
scroll.BorderSizePixel = 0
scroll.ScrollBarThickness = 4

local uiList = Instance.new("UIListLayout", scroll)
uiList.Padding = UDim.new(0, 5)
uiList.SortOrder = Enum.SortOrder.LayoutOrder

-- Funktion zum Erstellen der Buttons
local function updatePlayerList()
	scroll:ClearAllChildren()
	for _, p in pairs(players:GetPlayers()) do
		if p ~= player then
			local btn = Instance.new("TextButton", scroll)
			btn.Size = UDim2.new(1, 0, 0, 36)
			btn.Text = "üîÅ " .. p.Name
			btn.Font = Enum.Font.Gotham
			btn.TextColor3 = Color3.new(1, 1, 1)
			btn.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
			local btnCorner = Instance.new("UICorner", btn)
			btnCorner.CornerRadius = UDim.new(0, 6)

			btn.MouseButton1Click:Connect(function()
				local function teleport()
					local myHRP = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
					local targetHRP = p.Character and p.Character:FindFirstChild("HumanoidRootPart")
					if myHRP and targetHRP then
						myHRP.CFrame = targetHRP.CFrame + Vector3.new(2, 0, 0)
					end
				end
				teleport()
			end)
		end
	end
	scroll.CanvasSize = UDim2.new(0, 0, 0, uiList.AbsoluteContentSize.Y)
end

-- Wieder aktiv nach Respawn
player.CharacterAdded:Connect(function()
	task.wait(1)
	updatePlayerList()
end)

-- Verbindungen
listBtn.MouseButton1Click:Connect(updatePlayerList)
closeBtn.MouseButton1Click:Connect(function()
	menu.Visible = false
end)
openBtn.MouseButton1Click:Connect(function()
	menu.Visible = true
end)
